{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\nLet $n \\in \\mathbf{N}$ and $r \\in \\mathbf{N}^*$.\\n(a) Find the number of ways of distributing $r$ distinct objects into $n$ distinct boxes such that the objects in each box are ordered.\\n(b) Let $a_r$ denote the number of ways to select at most $r$ objects from $r$ distinct objects and to distribute them into $n$ distinct boxes such that the objects in each box are ordered. Show that\\n(i) $a_r = \\sum_{i=0}^r \\binom{r}{i} n^{(i)}$, where $n^{(i)} = n(n+1) \\cdots (n+i-1)$ with $n^{(0)} = 1$;\\n(ii) the exponential generating function for the sequence $(a_r)$ is given\\nby\\n$$e^x(1-x)^{-n}.$$"}, {"role": "assistant", "content": "<think>\n(a) To find the number of ways to distribute $r$ distinct objects into $n$ distinct boxes such that the objects in each box are ordered, we can use the following combinatorial reasoning:\n1.  Imagine the $r$ distinct objects and $n-1$ identical dividers used to separate the $n$ boxes.\n2.  The total number of positions for objects and dividers is $r + (n-1)$.\n3.  First, we choose the positions for the $n-1$ dividers from the $r+n-1$ available positions. This can be done in $\\binom{r+n-1}{n-1}$ ways.\n4.  Once the divider positions are fixed, there are $r$ remaining positions for the $r$ distinct objects. Since the objects are distinct and their order within each box matters, we multiply by the number of permutations of these $r$ objects, which is $r!$.\n5.  Therefore, the number of ways $b_r$ is:\n    $$b_r = \\binom{n+r-1}{n-1} \\times r! = \\frac{(n+r-1)!}{(n-1)!r!} \\times r! = \\frac{(n+r-1)!}{(n-1)!}$$\n6.  Expanding the factorial, we get:\n    $$b_r = \\frac{(n+r-1)(n+r-2)\\cdots(n+1)n(n-1)!}{(n-1)!} = n(n+1)\\cdots(n+r-1)$$\n7.  This is defined as the rising factorial $n^{(r)}$. Thus, the number of ways is $n^{(r)}$.\n\n(b) (i) We are asked to find $a_r$, the number of ways to select at most $r$ objects from $r$ distinct objects and distribute them into $n$ distinct boxes with ordered contents.\n1.  Suppose we select exactly $i$ objects from the $r$ available objects, where $0 \\le i \\le r$.\n2.  The number of ways to select $i$ objects is $\\binom{r}{i}$.\n3.  From part (a), the number of ways to distribute these $i$ distinct objects into $n$ distinct boxes with ordered contents is $b_i = n^{(i)}$.\n4.  By the Multiplication Principle, the number of ways to select and distribute exactly $i$ objects is $\\binom{r}{i} n^{(i)}$.\n5.  Since the selection of different numbers of objects are mutually exclusive events, we use the Addition Principle to sum over all possible values of $i$ from $0$ to $r$:\n    $$a_r = \\sum_{i=0}^r \\binom{r}{i} n^{(i)}$$\n\n(ii) We need to find the exponential generating function (EGF) for the sequence $(a_r)$. The EGF is defined as $A(x) = \\sum_{r=0}^\\infty \\frac{a_r}{r!} x^r$.\n1.  Substitute the expression for $a_r$ from part (b)(i):\n    $$A(x) = \\sum_{r=0}^\\infty \\left( \\sum_{i=0}^r \\binom{r}{i} n^{(i)} \\right) \\frac{x^r}{r!}$$\n2.  Rewrite the double summation by changing the order of summation:\n    $$A(x) = \\sum_{i=0}^\\infty \\sum_{r=i}^\\infty \\frac{1}{r!} \\binom{r}{i} n^{(i)} x^r$$\n3.  Simplify the term $\\frac{1}{r!} \\binom{r}{i}$:\n    $$\\frac{1}{r!} \\cdot \\frac{r!}{i!(r-i)!} = \\frac{1}{i!(r-i)!}$$\n4.  Substitute this back into the summation:\n    $$A(x) = \\sum_{i=0}^\\infty \\frac{n^{(i)}}{i!} \\sum_{r=i}^\\infty \\frac{x^r}{(r-i)!}$$\n5.  Let $k = r-i$. The inner sum becomes:\n    $$\\sum_{k=0}^\\infty \\frac{x^{i+k}}{k!} = x^i \\sum_{k=0}^\\infty \\frac{x^k}{k!} = x^i e^x$$\n6.  Substitute this back into $A(x)$:\n    $$A(x) = e^x \\sum_{i=0}^\\infty \\frac{n^{(i)}}{i!} x^i$$\n7.  Recognize that $\\frac{n^{(i)}}{i!} = \\frac{n(n+1)\\cdots(n+i-1)}{i!} = \\binom{n+i-1}{i}$.\n8.  The series $\\sum_{i=0}^\\infty \\binom{n+i-1}{i} x^i$ is the Taylor series for $(1-x)^{-n}$ (the negative binomial series).\n9.  Therefore:\n    $$A(x) = e^x (1-x)^{-n}$$\nThis confirms the required identity.</think>The answers are\n(a) $n^{(r)} = n(n+1)\\cdots(n+r-1)$,\n(b) (i) $a_r = \\sum_{i=0}^r \\binom{r}{i} n^{(i)}$ is shown by selecting $i$ objects in $\\binom{r}{i}$ ways and distributing them in $n^{(i)}$ ways,\n(ii) the exponential generating function is $A(x) = \\sum_{r=0}^\\infty \\frac{a_r}{r!}x^r = e^x(1-x)^{-n}$."}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\n(i) The largest square of asterisks in the upper left-hand corner of the Ferrers diagram is called the Durfee square of the diagram. Find the generating function for the number of self-conjugate partitions of $r$ whose Durfee square is an $m \\times m$ square, where $m \\in \\mathbf{N}$. \\n(ii) Deduce that \\n$$\\prod_{k=0}^{\\infty} (1 + x^{2k+1}) = 1 + \\sum_{m=1}^{\\infty} \\frac{x^{m^2}}{\\prod_{k=1}^{m} (1 - x^{2k})}$$"}, {"role": "assistant", "content": "<think>\nTo find the generating function for self-conjugate partitions of $r$ with an $m \\times m$ Durfee square, we analyze the structure of their Ferrers diagrams. A self-conjugate partition is symmetric across the main diagonal. Removing the $m \\times m$ Durfee square leaves two identical parts: one to the right and one below the square. Because the partition is self-conjugate, the part to the right (rows of length $\\le m$) is the conjugate of the part below (columns of length $\\le m$).\n\nThe number of asterisks in the square is $m^2$. Let the remaining asterisks be $r - m^2$. These are distributed into the two identical regions. If the region to the right has rows $n_1, n_2, \\dots, n_k$ where $n_1 \\le m$, then the total number of asterisks added to the $m^2$ block is $2 \\sum n_i$. This is equivalent to a partition of $r - m^2$ into even parts $\\{2n_1, 2n_2, \\dots, 2n_k\\}$ where each part $2n_i \\le 2m$. The generating function for partitions into even parts $\\le 2m$ is given by $\\prod_{k=1}^m \\frac{1}{1-x^{2k}}$. Accounting for the $m^2$ asterisks in the Durfee square, the generating function for self-conjugate partitions with a fixed $m \\times m$ Durfee square is:\n$$\\frac{x^{m^2}}{\\prod_{k=1}^m (1 - x^{2k})}$$\n\nFor part (ii), we recall that the generating function for partitions into distinct odd parts is $\\prod_{k=0}^{\\infty} (1 + x^{2k+1})$. It is a known combinatorial identity that the number of self-conjugate partitions of $r$ equals the number of partitions of $r$ into distinct odd parts. Summing the generating functions from part (i) over all possible sizes of the Durfee square $m \\ge 1$, and adding 1 for the empty partition (where $m=0$), we obtain the total generating function for self-conjugate partitions:\n$$1 + \\sum_{m=1}^{\\infty} \\frac{x^{m^2}}{\\prod_{k=1}^m (1 - x^{2k})}$$\nEquating the two expressions for the same sequence of partitions yields the identity.\n</think>\n\nThe answers are (i) $\\frac{x^{m^2}}{\\prod_{k=1}^{m} (1 - x^{2k})}$, (ii) $\\prod_{k=0}^{\\infty} (1 + x^{2k+1}) = 1 + \\sum_{m=1}^{\\infty} \\frac{x^{m^2}}{\\prod_{k=1}^{m} (1 - x^{2k})}$."}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\n\\sum_{r=m}^{n} \\binom{n}{r} \\binom{r}{m} = 2^{n-m} \\binom{n}{m} \\text{ for } 0 < m \\le n,"}, {"role": "assistant", "content": "<think>\nTo evaluate the sum $\\sum_{r=m}^{n} \\binom{n}{r} \\binom{r}{m}$, we first apply the subset-of-a-subset identity: $\\binom{n}{r} \\binom{r}{m} = \\binom{n}{m} \\binom{n-m}{r-m}$. Substituting this into the summation, we factor out $\\binom{n}{m}$ as it is independent of $r$. By re-indexing the sum with $k = r-m$, we transform it into $\\sum_{k=0}^{n-m} \\binom{n-m}{k}$, which is equal to $2^{n-m}$ based on the binomial theorem property for the sum of a row in Pascal's triangle. Multiplying these components yields the final expression.\n</think>\n\nThe answer is $2^{n-m} \\binom{n}{m}$."}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\nGiven $n, k \\in \\mathbf{N}$, show that the number of partitions of $n$ into $k$ distinct parts is equal to $p(n - \\binom{k}{2}, k)$."}, {"role": "assistant", "content": "<think>\nTo show that the number of partitions of $n$ into $k$ distinct parts is equal to $p(n - \\binom{k}{2}, k)$, we establish a bijection between the set of partitions of $n$ into $k$ distinct parts and the set of partitions of $n - \\binom{k}{2}$ into $k$ parts. By transforming the parts of a partition with distinct values into a partition with non-negative values through the subtraction of a specific arithmetic progression, we verify that the total sum is reduced by $\\binom{k}{2}$ while maintaining the required number of parts. This mapping is reversible, confirming the equality of the sizes of the two sets.\n</think>\n\nThe number of partitions of $n$ into $k$ distinct parts is equal to $p(n - \\binom{k}{2}, k)$."}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\nLet $n$ distinct points in the plane be given. Prove that fewer than $2n^{\\frac{3}{2}}$ pairs of them are at unit distance apart. (Putnam, 1978)"}, {"role": "assistant", "content": "<think>\nTo prove that the number of pairs of points at unit distance apart is fewer than $2n^{3/2}$, let $P = \\{a_1, a_2, \\dots, a_n\\}$ be the set of $n$ distinct points in the plane.\n\n1.  **Define the variables:**\n    Let $m_i$ be the number of points in $P$ that are at unit distance from point $a_i$. This is equivalent to the number of points $a_j$ such that $d(a_i, a_j) = 1$. Let $N$ be the total number of such unit distance pairs $\\{a_i, a_j\\}$. Since each pair is counted twice in the sum of $m_i$ (once for $a_i$ and once for $a_j$), we have:\n    $$N = \\frac{1}{2} \\sum_{i=1}^n m_i$$\n    We wish to show that $N < 2n^{3/2}$, or equivalently, $\\sum_{i=1}^n m_i < 4n^{3/2}$.\n\n2.  **Geometric Interpretation:**\n    For each point $a_i$, let $C_i$ be the circle of unit radius centered at $a_i$. A point $a_j$ is at unit distance from $a_i$ if and only if $a_j$ lies on the circumference of $C_i$. Thus, $m_i$ is the number of points from the set $P$ that lie on the circle $C_i$.\n\n3.  **Counting Pairs of Circles:**\n    Consider the set $S$ of triples $(a_k, C_i, C_j)$ such that point $a_k$ lies on the intersection of distinct circles $C_i$ and $C_j$:\n    $$S = \\{(a_k, \\{C_i, C_j\\}) : a_k \\in C_i \\cap C_j, i < j\\}$$\n    We can count the size of $S$ in two ways:\n    - **By point $a_k$:** For a fixed point $a_k$, the number of circles $C_i$ passing through it is $m_k$ (because $a_k \\in C_i \\iff d(a_k, a_i) = 1$). To form a triple, we choose 2 circles from these $m_k$ circles. Thus, there are $\\binom{m_k}{2}$ such pairs for each $a_k$. Summing over all $k$:\n      $$|S| = \\sum_{k=1}^n \\binom{m_k}{2}$$\n    - **By pair of circles $\\{C_i, C_j\\}$:** Any two distinct circles $C_i$ and $C_j$ intersect in at most 2 points. Since there are $\\binom{n}{2}$ pairs of circles, the total number of intersection points $a_k$ across all pairs is at most:\n      $$|S| \\le 2 \\binom{n}{2} = 2 \\cdot \\frac{n(n-1)}{2} = n(n-1)$$\n\n4.  **Algebraic Inequality:**\n    Combining the two results for $|S|$, we get:\n    $$\\sum_{k=1}^n \\frac{m_k(m_k-1)}{2} \\le n(n-1) \\implies \\sum_{k=1}^n m_k^2 - \\sum_{k=1}^n m_k \\le 2n^2 - 2n$$\n    Let $E = \\sum_{k=1}^n m_k$. By the Cauchy-Schwarz inequality, $\\left(\\sum_{k=1}^n m_k\\right)^2 \\le n \\sum_{k=1}^n m_k^2$, so $\\sum m_k^2 \\ge \\frac{E^2}{n}$. Substituting this into the inequality:\n    $$\\frac{E^2}{n} - E \\le \\sum m_k^2 - \\sum m_k \\le 2n^2 - 2n$$\n    $$E^2 - nE - (2n^3 - 2n^2) \\le 0$$\n\n5.  **Solving for E:**\n    The roots of the quadratic $x^2 - nx - (2n^3 - 2n^2) = 0$ are:\n    $$x = \\frac{n \\pm \\sqrt{n^2 + 4(2n^3 - 2n^2)}}{2} = \\frac{n \\pm \\sqrt{8n^3 - 7n^2}}{2}$$\n    Since $E \\ge 0$, we have:\n    $$E \\le \\frac{n + \\sqrt{8n^3 - 7n^2}}{2} < \\frac{n + \\sqrt{8n^3}}{2} = \\frac{n}{2} + \\sqrt{2}n^{3/2}$$\n    For $n \\ge 1$, we have $n \\le n^{3/2}$, so:\n    $$E < \\left(\\frac{1}{2} + \\sqrt{2}\\right)n^{3/2} \\approx 1.914n^{3/2}$$\n\n6.  **Conclusion:**\n    The number of unit distance pairs $N$ is:\n    $$N = \\frac{1}{2} E < \\frac{1.914}{2} n^{3/2} = 0.957n^{3/2}$$\n    Since $0.957n^{3/2} < 2n^{3/2}$ for all $n \\ge 1$, the proof is complete.\n\nThe answer is $N < 2n^{\\frac{3}{2}}$.</think>The number of pairs of points at unit distance can be bounded using a geometric counting argument. Let $a_1, a_2, \\dots, a_n$ be the given $n$ distinct points and $m_i$ be the number of points at unit distance from $a_i$. The total number of unit distance pairs is $N = \\frac{1}{2} \\sum_{i=1}^n m_i$.\n\nFor each point $a_i$, consider a circle $C_i$ of unit radius centered at $a_i$. The $m_i$ points at unit distance from $a_i$ are the points from the set that lie on the circle $C_i$. We count the number of triples $(a_k, C_i, C_j)$ where $a_k$ is a point lying on the intersection of distinct circles $C_i$ and $C_j$.\n\n1. Summing over points $a_k$, each point $a_k$ lies on $m_k$ circles, so it is an intersection point for $\\binom{m_k}{2}$ pairs of circles. The total number of such triples is $\\sum_{k=1}^n \\binom{m_k}{2}$.\n2. Summing over pairs of circles $\\{C_i, C_j\\}$, any two distinct circles intersect in at most 2 points. There are $\\binom{n}{2}$ pairs of circles, so the total number of intersection points is at most $2\\binom{n}{2} = n(n-1)$.\n\nEquating these, we have:\n$$\\sum_{k=1}^n \\frac{m_k(m_k-1)}{2} \\le n(n-1) \\implies \\sum_{k=1}^n m_k^2 - \\sum_{k=1}^n m_k \\le 2n^2 - 2n$$\nLet $E = \\sum m_k$. By the Cauchy-Schwarz inequality, $\\sum m_k^2 \\ge \\frac{E^2}{n}$. Thus:\n$$\\frac{E^2}{n} - E \\le 2n^2 - 2n \\implies E^2 - nE - (2n^3 - 2n^2) \\le 0$$\nSolving the quadratic for $E$ yields:\n$$E \\le \\frac{n + \\sqrt{8n^3 - 7n^2}}{2} < \\frac{n}{2} + \\sqrt{2}n^{3/2}$$\nFor $n \\ge 1$, $n \\le n^{3/2}$, so $E < (\\frac{1}{2} + \\sqrt{2})n^{3/2} < 2n^{3/2}$.\nThe number of unit distance pairs is $N = \\frac{E}{2} < n^{3/2}$. Since $n^{3/2} < 2n^{3/2}$, the result follows.\n\nThe answer is $N < 2n^{\\frac{3}{2}}$."}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\nShow that for $n \\in \\mathbf{N}$ with $n \\ge 2$,\\n$$\\sum_{r=1}^n r \\sqrt{\\binom{n}{r}} < \\sqrt{2^{n-1} n^3}.$$\\n(Spanish MO, 1988)"}, {"role": "assistant", "content": "<think>\nTo prove the inequality $\\sum_{r=1}^n r \\sqrt{\\binom{n}{r}} < \\sqrt{2^{n-1} n^3}$, we apply the identity $r \\binom{n}{r} = n \\binom{n-1}{r-1}$ to rewrite the expression as $\\sqrt{n} \\sum_{r=1}^n \\sqrt{r \\binom{n-1}{r-1}}$. Applying the Cauchy-Schwarz inequality to the sequences $a_r = \\sqrt{r}$ and $b_r = \\sqrt{\\binom{n-1}{r-1}}$ yields $\\sqrt{n} \\sqrt{\\sum_{r=1}^n r} \\sqrt{\\sum_{r=1}^n \\binom{n-1}{r-1}}$. Evaluating the sums results in $\\sqrt{n} \\sqrt{\\frac{n(n+1)}{2}} \\sqrt{2^{n-1}}$, which simplifies to $\\sqrt{\\frac{n^2(n+1)2^{n-1}}{2}} = \\sqrt{n^2 \\frac{n+1}{2} 2^{n-1}}$. Since $n \\ge 2$, we have $\\frac{n+1}{2} < n$, leading to the strictly smaller upper bound $\\sqrt{2^{n-1} n^3}$.\n</think>\n\nThe answer is $\\sum_{r=1}^n r \\sqrt{\\binom{n}{r}} < \\sqrt{2^{n-1} n^3}$."}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\n(i) Applying the arithmetic-geometric mean inequality on\\n\\n$$\\binom{n+1}{1}, \\binom{n+1}{2}, \\dots, \\binom{n+1}{n},$$\\n\\nshow that\\n\\n$$(2^{n+1} - 2)^n \\ge n^n \\prod_{r=1}^n \\binom{n+1}{r},$$\\n\\nwhere $n \\in \\mathbb{N}$.\\n(ii) Show that\\n\\n$$(n!)^{n+1} = \\left(\\prod_{r=1}^n r^r\\right) \\left(\\prod_{r=1}^n (r!)\\right).$$\\n\\n(iii) Deduce from (i) and (ii) or otherwise, that\\n\\n$$\\left(\\frac{n(n+1)!}{2^{n+1}-2}\\right)^{\\frac{n}{2}} \\le \\frac{(n!)^{n+1}}{\\prod_{r=1}^n r^r}.$$\\n\\n(iv) Show that the equality in (iii) holds iff $n = 1$ or $n = 2$. (See The College Math. J., 20 (1989), 344.)"}, {"role": "assistant", "content": "<think>\nTo solve part (i), we apply the Arithmetic-Geometric Mean (AM-GM) Inequality to the set of $n$ binomial coefficients $\\binom{n+1}{1}, \\binom{n+1}{2}, \\dots, \\binom{n+1}{n}$. We calculate the sum of these coefficients using the identity $\\sum_{r=0}^{n+1} \\binom{n+1}{r} = 2^{n+1}$ and subtracting the terms for $r=0$ and $r=n+1$, yielding a sum of $2^{n+1}-2$. Raising the AM-GM expression to the power of $n$ yields the desired inequality.\n\nFor part (ii), we establish the identity $(n!)^{n+1} = \\left(\\prod_{r=1}^n r^r\\right) \\left(\\prod_{r=1}^n r!\\right)$ by first proving $\\prod_{r=1}^{n} r^{n+1-r} = \\prod_{r=1}^{n} r!$. This is done by recognizing that $r!$ is the product of integers from 1 to $r$, and in the product of all factorials up to $n$, each integer $k$ appears in the factorials $k!, (k+1)!, \\dots, n!$, which is exactly $n-k+1$ times.\n\nIn part (iii), we manipulate the expression $\\left(\\frac{n(n+1)!}{2^{n+1}-2}\\right)^{\\frac{n}{2}}$ by substituting the inequality from part (i) into the denominator. By simplifying the product of binomial coefficients $\\prod_{r=1}^n \\binom{n+1}{r}$ and using the identity from part (ii), we show it is less than or equal to $\\frac{(n!)^{n+1}}{\\prod_{r=1}^n r^r}$.\n\nFinally, for part (iv), we identify that equality holds in (iii) only when the AM-GM inequality in (i) holds as an equality. This requires all terms $\\binom{n+1}{r}$ for $r=1, \\dots, n$ to be equal. Due to the unimodal nature of binomial coefficients, this only occurs when the list has at most two elements that are central, which corresponds to $n=1$ and $n=2$.\n</think>\n\nThe answers are (i) $(2^{n+1} - 2)^n \\ge n^n \\prod_{r=1}^n \\binom{n+1}{r}$ by AM-GM, (ii) $(n!)^{n+1} = \\left(\\prod_{r=1}^n r^r\\right) \\left(\\prod_{r=1}^n (r!)\\right)$ by index manipulation, (iii) $\\left(\\frac{n(n+1)!}{2^{n+1}-2}\\right)^{\\frac{n}{2}} \\le \\frac{(n!)^{n+1}}{\\prod_{r=1}^n r^r}$ by combining (i) and (ii), (iv) equality holds iff $n=1$ or $n=2$."}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\nLet $S = \\{1, 2, 3, \\dots, 1992\\}$. In each of the following cases, find the number of 3-element subsets $\\{a, b, c\\}$ of $S$ satisfying the given condition:\\n(i) $3|(a + b + c)$;\\n(ii) $4|(a + b + c)$."}, {"role": "assistant", "content": "<think>To solve for the number of 3-element subsets $\\{a, b, c\\}$ of $S = \\{1, 2, 3, \\dots, 1992\\}$ such that their sum is divisible by a given integer $m$, we follow these steps:\n\n1.  **Partition the Set:** We divide $S$ into $m$ residue classes $R_k = \\{x \\in S \\mid x \\equiv k \\pmod m\\}$. For part (i), $m=3$, and for part (ii), $m=4$. Since 1992 is divisible by both 3 and 4, each residue class $R_k$ contains an equal number of elements: $1992/3 = 664$ for part (i) and $1992/4 = 498$ for part (ii).\n2.  **Determine Residue Combinations:** We identify all multisets of residues $\\{r_1, r_2, r_3\\}$ such that $r_1 + r_2 + r_3 \\equiv 0 \\pmod m$.\n3.  **Count Subsets per Combination:** For each residue combination, we calculate the number of ways to choose 3 distinct integers from $S$.\n    *   If $r_1 = r_2 = r_3$, we choose 3 distinct elements from the same residue class: $\\binom{|R_k|}{3}$.\n    *   If $r_1, r_2, r_3$ are all distinct, we choose one element from each class: $|R_{r_1}| \\cdot |R_{r_2}| \\cdot |R_{r_3}|$.\n    *   If two residues are the same (e.g., $r_1 = r_2 \\neq r_3$), we choose 2 distinct elements from class $R_{r_1}$ and one from $R_{r_3}$: $\\binom{|R_{r_1}|}{2} \\cdot |R_{r_3}|$.\n4.  **Sum the Totals:**\n    *   For (i), the possible residue multisets are $\\{0,0,0\\}$, $\\{1,1,1\\}$, $\\{2,2,2\\}$, and $\\{0,1,2\\}$. The total number of subsets is $3\\binom{664}{3} + 664^3$.\n    *   For (ii), the possible residue multisets are $\\{0,0,0\\}$, $\\{0,1,3\\}$, $\\{0,2,2\\}$, $\\{1,1,2\\}$, and $\\{2,3,3\\}$. The total number of subsets is $\\binom{498}{3} + 498^3 + 3 \\cdot 498 \\binom{498}{2}$.\n5.  **Calculate Final Values:** We evaluate the combinations and powers to arrive at the final numerical answers.</think>The answers are (i) 438,471,736, (ii) 328,853,470."}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\nThe geometric mean (G.M.) of $k$ positive numbers $a_1, a_2, \\dots, a_k$ is defined to be the (positive) $k$th root of their product. For example, the G.M. of 3, 4, 18 is 6. Show that the G.M. of a set $S$ of $n$ positive numbers is equal to the G.M. of the G.M.'s of all nonempty subsets of $S$. (Canadian MO, 1983)"}, {"role": "assistant", "content": "<think>\nTo find the geometric mean (G.M.) of the G.M.'s of all $2^n - 1$ nonempty subsets of $S = \\{a_1, a_2, \\dots, a_n\\}$, we calculate the total product of all subset G.M.'s. For each element $a_i \\in S$, we determine its exponent in the overall product by counting how many subsets of size $k$ contain $a_i$, which is $\\binom{n-1}{k-1}$. Summing the contributions $\\frac{1}{k}$ for all $k \\in \\{1, \\dots, n\\}$ using the identity $\\frac{1}{k} \\binom{n-1}{k-1} = \\frac{1}{n} \\binom{n}{k}$, we find the total exponent for $a_i$ is $\\frac{2^n - 1}{n}$. Taking the $(2^n - 1)$-th root of the resulting product $(a_1 a_2 \\dots a_n)^{\\frac{2^n - 1}{n}}$ yields $(a_1 a_2 \\dots a_n)^{1/n}$, which is the G.M. of $S$.\n</think>\n\nThe answer is $(a_1 a_2 \\dots a_n)^{1/n}$."}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\nProve that\\n\\sum \\frac{1}{k_1!k_2! \\cdots k_n!} = \\frac{1}{r!} \\binom{n-1}{r-1},\\nwhere the sum is taken over all k_1, k_2, \\dots, k_n \\in \\mathbb{N}^* with \\sum_{i=1}^n k_i = r and \\sum_{i=1}^n ik_i = n.\\n(Proposed by D. \u017d. Djokovi\u0107, see Amer. Math. Monthly, 77 (1970), 659.)"}, {"role": "assistant", "content": "<think>\nTo prove the identity, we analyze the generating function for the sum $\\sum \\frac{1}{k_1!k_2! \\cdots k_n!}$ under the given constraints.\n\n1.  **Application of the Multinomial Theorem**:\n    We start with the Multinomial Theorem:\n    $$(x_1 + x_2 + \\dots + x_n)^r = r! \\sum_{\\sum k_i = r} \\frac{x_1^{k_1} x_2^{k_2} \\dots x_n^{k_n}}{k_1! k_2! \\dots k_n!}$$\n    To align this with the constraint $\\sum i k_i = n$, we substitute $x_i = x^i$ for $i=1, 2, \\dots, n$. This yields:\n    $$(x + x^2 + \\dots + x^n)^r = r! \\sum_{\\sum k_i = r} \\frac{x^{\\sum i k_i}}{k_1! k_2! \\dots k_n!}$$\n\n2.  **Expanding the Generating Function**:\n    The left side can be rewritten and expanded using the binomial series:\n    $$(x + x^2 + \\dots + x^n)^r = x^r (1 + x + \\dots + x^{n-1})^r = x^r \\left( \\frac{1-x^n}{1-x} \\right)^r = x^r (1-x^n)^r (1-x)^{-r}$$\n    Using the binomial expansions $(1-x^n)^r = \\sum_{i=0}^r \\binom{r}{i} (-1)^i x^{ni}$ and $(1-x)^{-r} = \\sum_{j=0}^\\infty \\binom{r+j-1}{j} x^j$:\n    $$(x + x^2 + \\dots + x^n)^r = \\sum_{i=0}^r \\sum_{j=0}^\\infty (-1)^i \\binom{r}{i} \\binom{r+j-1}{j} x^{ni+j+r}$$\n\n3.  **Comparing Coefficients**:\n    The sum we wish to evaluate is the coefficient of $x^n$ in the first expression, divided by $r!$.\n    We find the coefficient of $x^n$ in the expanded double sum by solving $ni + j + r = n$. Since $n, r \\ge 1$, the only non-negative integer solution is $i=0$ and $j = n-r$.\n    The coefficient at $i=0, j=n-r$ is:\n    $$(-1)^0 \\binom{r}{0} \\binom{r+(n-r)-1}{n-r} = 1 \\cdot 1 \\cdot \\binom{n-1}{n-r} = \\binom{n-1}{r-1}$$\n    Equating the coefficients from both sides and dividing by $r!$ completes the proof.\n</think>\n\nThe answer is \\frac{1}{r!} \\binom{n-1}{r-1}."}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\nThe edges of the 7-clique $K_7$ are coloured by 2 colours: blue or red. Show that there are at least four monochromatic 3-cliques in the resulting configuration."}, {"role": "assistant", "content": "<think>\nTo determine the minimum number of monochromatic 3-cliques in a 2-coloured $K_7$, we calculate the maximum possible number of non-monochromatic 3-cliques. By counting pairs of edges of different colours incident to each vertex $v$, where $k_v$ is the number of blue edges and $6-k_v$ is the number of red edges, we find the total number of such pairs is $\\sum_{v \\in V} k_v(6-k_v)$. Since $k_v(6-k_v) \\leq 9$ for $k_v \\in \\{0, \\dots, 6\\}$, the total number of non-monochromatic pairs is at most $7 \\times 9 = 63$. Each non-monochromatic 3-clique contains exactly two such pairs, so there are at most $\\lfloor 63/2 \\rfloor = 31$ non-monochromatic 3-cliques. Subtracting this from the total number of 3-cliques, $\\binom{7}{3} = 35$, yields at least 4 monochromatic 3-cliques.\n</think>\n\nThe answer is 4."}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\nShow that for $n \\in \\mathbf{N}^*$,\\n\\n$$F_{n+1} = \\begin{vmatrix} 1 & -1 & 0 & 0 & \\dots & 0 & 0 \\\\ 1 & 1 & -1 & 0 & \\dots & 0 & 0 \\\\ 0 & 1 & 1 & -1 & \\dots & 0 & 0 \\\\ \\vdots & \\vdots & \\vdots & \\vdots & \\ddots & \\vdots & \\vdots \\\\ 0 & 0 & 0 & 0 & \\dots & 1 & -1 \\\\ 0 & 0 & 0 & 0 & \\dots & 1 & 1 \\end{vmatrix}.$$"}, {"role": "assistant", "content": "<think>\nTo prove that the given $n \\times n$ determinant $a_n$ equals the $(n+1)$-th Fibonacci number $F_{n+1}$, we use mathematical induction and cofactor expansion. First, we verify the base cases $a_1 = 1 = F_2$ and $a_2 = 2 = F_3$. We then establish a recurrence relation for $a_n$ by expanding the determinant along the first row, which yields $a_n = 1 \\cdot a_{n-1} - (-1) \\cdot b_{n-1}$, where $b_{n-1}$ is the minor resulting from the first row and second column. Expanding $b_{n-1}$ along its first column shows that $b_{n-1} = a_{n-2}$. Substituting this back, we obtain the Fibonacci recurrence $a_n = a_{n-1} + a_{n-2}$, with the same starting values as $F_{n+1}$, thereby proving $a_n = F_{n+1}$ for all $n \\in \\mathbf{N}^*$.\n</think>\n\nThe answer is $F_{n+1} = a_n$."}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\nFor n \\in \\mathbf{N}, let F_n denote the nth Fibonacci number. Thus\n\nF_1 = 1, F_2 = 1, F_3 = 2, F_4 = 3, F_5 = 5, F_6 = 8, \\dots\n\nand by Example 6.3.1,\n\nF_{n+2} = F_n + F_{n+1}\n\nand $F_n = \\frac{1}{\\sqrt{5}} \\left\\{ \\left( \\frac{1+\\sqrt{5}}{2} \\right)^n - \\left( \\frac{1-\\sqrt{5}}{2} \\right)^n \\right\\}$.\\nShow that\\n(i) $\\sum_{r=1}^n F_r = F_{n+2} - 1$;\\n(ii) $\\sum_{r=1}^n F_{2r} = F_{2n+1} - 1$;\\n(iii) $\\sum_{r=1}^n F_{2r-1} = F_{2n}$;\\n(iv) $\\sum_{r=1}^n (-1)^{r+1} F_r = (-1)^{n+1} F_{n-1} + 1$."}, {"role": "assistant", "content": "<think>\nTo prove these Fibonacci identities, we apply the principle of mathematical induction and the fundamental recurrence relation $F_{n+2} = F_{n+1} + F_n$.\n\n(i) For the sum of the first $n$ Fibonacci numbers, we verify the base case $n=1$ ($F_1 = F_3 - 1$) and use the induction hypothesis $\\sum_{r=1}^k F_r = F_{k+2} - 1$ to show that adding $F_{k+1}$ results in $F_{k+3} - 1$.\n(ii) For the sum of even-indexed Fibonacci numbers, we verify $n=1$ ($F_2 = F_3 - 1$) and use the hypothesis $\\sum_{r=1}^k F_{2r} = F_{2k+1} - 1$ to show that adding $F_{2k+2}$ results in $F_{2k+3} - 1$.\n(iii) For the sum of odd-indexed Fibonacci numbers, we verify $n=1$ ($F_1 = F_2$) and use the hypothesis $\\sum_{r=1}^k F_{2r-1} = F_{2k}$ to show that adding $F_{2k+1}$ results in $F_{2k+2}$.\n(iv) For the alternating sum, we verify the base case and use the hypothesis $\\sum_{r=1}^k (-1)^{r+1} F_r = (-1)^{k+1} F_{k-1} + 1$ to demonstrate that adding $(-1)^{k+2} F_{k+1}$ simplifies to $(-1)^{k+2} F_k + 1$ via the recurrence relation.\n</think>\n\nThe answers are (i) $\\sum_{r=1}^n F_r = F_{n+2} - 1$, (ii) $\\sum_{r=1}^n F_{2r} = F_{2n+1} - 1$, (iii) $\\sum_{r=1}^n F_{2r-1} = F_{2n}$, (iv) $\\sum_{r=1}^n (-1)^{r+1} F_r = (-1)^{n+1} F_{n-1} + 1$."}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\nSix distinct symbols are transmitted through a communication channel. A total of 18 blanks are to be inserted between the symbols with at least 2 blanks between every pair of symbols. In how many ways can the symbols and blanks be arranged?"}, {"role": "assistant", "content": "<think>\nTo solve this problem, we first determine the number of ways to arrange the six distinct symbols, which is $6!$. Next, we distribute the 18 blanks into the 5 spaces between the ordered symbols ($s_1, \\dots, s_6$). Letting $b_i$ be the number of blanks in the $i$-th space, we solve the equation $b_1 + b_2 + b_3 + b_4 + b_5 = 18$ subject to the constraint $b_i \\ge 2$. By substituting $c_i = b_i - 2$, we transform the problem into finding the number of non-negative integer solutions to $c_1 + c_2 + c_3 + c_4 + c_5 = 8$, which is given by the stars and bars formula $\\binom{8+5-1}{5-1} = \\binom{12}{4}$. Multiplying these independent choices gives the final result.\n</think>\n\nThe answer is $6! \\cdot \\binom{12}{4}$."}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\nSolve the recurrence relation\n$$na_n = (n-2)a_{n-1} + (n+1),$$\ngiven that $a_0 = 0$."}, {"role": "assistant", "content": "<think>\nTo solve the recurrence relation $na_n = (n-2)a_{n-1} + (n+1)$ with $a_0 = 0$, we use the method of generating functions.\n\n1.  **Define the Generating Function:**\n    Let $A(x) = \\sum_{n=0}^{\\infty} a_n x^n$ be the ordinary generating function for the sequence $(a_n)$.\n    Then its derivative is $A'(x) = \\sum_{n=1}^{\\infty} n a_n x^{n-1}$.\n\n2.  **Transform the Recurrence Relation:**\n    The recurrence is $na_n = (n-2)a_{n-1} + (n+1)$ for $n \\ge 1$.\n    Multiply both sides by $x^{n-1}$ and sum from $n=1$ to $\\infty$:\n    $$\\sum_{n=1}^{\\infty} n a_n x^{n-1} = \\sum_{n=1}^{\\infty} (n-2) a_{n-1} x^{n-1} + \\sum_{n=1}^{\\infty} (n+1) x^{n-1}$$\n\n3.  **Evaluate Each Sum:**\n    *   **LHS:** $\\sum_{n=1}^{\\infty} n a_n x^{n-1} = A'(x)$.\n    *   **First Sum on RHS:**\n        $$\\sum_{n=1}^{\\infty} (n-2) a_{n-1} x^{n-1} = \\sum_{n=1}^{\\infty} (n-1) a_{n-1} x^{n-1} - \\sum_{n=1}^{\\infty} a_{n-1} x^{n-1}$$\n        Let $k = n-1$:\n        $$\\sum_{k=0}^{\\infty} k a_k x^k - \\sum_{k=0}^{\\infty} a_k x^k = x \\sum_{k=1}^{\\infty} k a_k x^{k-1} - A(x) = x A'(x) - A(x)$$\n    *   **Second Sum on RHS:**\n        Recalling the standard series $(1-x)^{-2} = \\sum_{n=0}^{\\infty} (n+1) x^n$, we have:\n        $$\\sum_{n=1}^{\\infty} (n+1) x^{n-1} = \\frac{1}{x} \\sum_{n=1}^{\\infty} (n+1) x^n = \\frac{1}{x} \\left( \\sum_{n=0}^{\\infty} (n+1) x^n - 1 \\right)$$\n        $$= \\frac{1}{x} \\left( \\frac{1}{(1-x)^2} - 1 \\right) = \\frac{1 - (1-x)^2}{x(1-x)^2} = \\frac{2x - x^2}{x(1-x)^2} = \\frac{2-x}{(1-x)^2}$$\n\n4.  **Formulate the Differential Equation:**\n    Substituting the sums back into the equation:\n    $$A'(x) = x A'(x) - A(x) + \\frac{2-x}{(1-x)^2}$$\n    $$(1-x) A'(x) + A(x) = \\frac{2-x}{(1-x)^2}$$\n    Dividing by $(1-x)^2$, we get:\n    $$\\frac{1}{1-x} A'(x) + \\frac{1}{(1-x)^2} A(x) = \\frac{2-x}{(1-x)^4}$$\n    The left side is the derivative of a product:\n    $$\\frac{d}{dx} \\left( \\frac{A(x)}{1-x} \\right) = \\frac{2-x}{(1-x)^4}$$\n\n5.  **Integrate to Solve for A(x):**\n    Rewrite the RHS as:\n    $$\\frac{2-x}{(1-x)^4} = \\frac{1 + (1-x)}{(1-x)^4} = \\frac{1}{(1-x)^4} + \\frac{1}{(1-x)^3}$$\n    Integrating both sides:\n    $$\\frac{A(x)}{1-x} = \\int \\left( (1-x)^{-4} + (1-x)^{-3} \\right) dx = \\frac{(1-x)^{-3}}{3} + \\frac{(1-x)^{-2}}{2} + C$$\n    $$A(x) = \\frac{1}{3(1-x)^2} + \\frac{1}{2(1-x)} + C(1-x)$$\n\n6.  **Apply Initial Conditions:**\n    Using $a_0 = 0$, we have $A(0) = a_0 = 0$:\n    $$A(0) = \\frac{1}{3} + \\frac{1}{2} + C = 0 \\implies C = -\\frac{5}{6}$$\n    Thus, $A(x) = \\frac{1}{3}(1-x)^{-2} + \\frac{1}{2}(1-x)^{-1} - \\frac{5}{6}(1-x)$.\n\n7.  **Find the General Term a_n:**\n    Expanding $A(x)$ into power series:\n    $$A(x) = \\frac{1}{3} \\sum_{n=0}^{\\infty} (n+1)x^n + \\frac{1}{2} \\sum_{n=0}^{\\infty} x^n - \\frac{5}{6} + \\frac{5}{6}x$$\n    *   For $n=0$: $a_0 = \\frac{1}{3}(1) + \\frac{1}{2}(1) - \\frac{5}{6} = 0$.\n    *   For $n=1$: $a_1 = \\frac{1}{3}(2) + \\frac{1}{2}(1) + \\frac{5}{6} = \\frac{4+3+5}{6} = 2$.\n    *   For $n \\ge 2$: $a_n = \\frac{1}{3}(n+1) + \\frac{1}{2} = \\frac{2n+2+3}{6} = \\frac{2n+5}{6}$.\n\nThe answers are $a_0 = 0, a_1 = 2$ and $a_n = \\frac{2n+5}{6}$ for all $n \\ge 2$.\n</think>The answer is $a_0 = 0, a_1 = 2, a_n = \\frac{2n+5}{6}$ for $n \\ge 2$."}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\nThe $n \\times n$ determinant $a_n$ is defined by\n$a_n = \\begin{vmatrix} p+q & pq & 0 & 0 & \\cdots & 0 & 0 \\\\ 1 & p+q & pq & 0 & \\cdots & 0 & 0 \\\\ 0 & 1 & p+q & pq & \\cdots & 0 & 0 \\\\ 0 & 0 & 1 & p+q & \\cdots & 0 & 0 \\\\ \\vdots & \\vdots & \\vdots & \\vdots & \\ddots & \\vdots & \\vdots \\\\ 0 & 0 & 0 & 0 & \\cdots & p+q & pq \\\\ 0 & 0 & 0 & 0 & \\cdots & 1 & p+q \\end{vmatrix}$\nwhere $p$ and $q$ are nonzero constants. Find a recurrence relation for $(a_n)$, and solve the recurrence relation."}, {"role": "assistant", "content": "<think>\nTo find the recurrence relation for the determinant $a_n$, we perform a cofactor expansion along the first row. This yields $a_n = (p+q)a_{n-1} - pq \\cdot b_{n-1}$, where $b_{n-1}$ is a minor. Expanding $b_{n-1}$ along its first column results in $b_{n-1} = a_{n-2}$, giving the linear homogeneous recurrence relation $a_n = (p+q)a_{n-1} - pqa_{n-2}$.\n\nThe characteristic equation for this recurrence is $x^2 - (p+q)x + pq = 0$, which factors as $(x-p)(x-q) = 0$, leading to the roots $x=p$ and $x=q$.\n\nIf $p \\neq q$, the general solution is $a_n = Ap^n + Bq^n$. Using the initial conditions $a_1 = p+q$ and $a_2 = p^2+pq+q^2$, we solve for the constants to find $A = \\frac{p}{p-q}$ and $B = \\frac{-q}{p-q}$, resulting in $a_n = \\frac{p^{n+1} - q^{n+1}}{p-q}$.\n\nIf $p = q$, the general solution is $a_n = (A+Bn)p^n$. Using initial conditions $a_1 = 2p$ and $a_2 = 3p^2$, we find $A=1$ and $B=1$, resulting in $a_n = (n+1)p^n$.\n</think>\n\nThe recurrence relation is $a_n = (p+q)a_{n-1} - pqa_{n-2}$ for $n \\ge 3$, with $a_1 = p+q$ and $a_2 = p^2+pq+q^2$. The solution to the recurrence relation is $a_n = \\begin{cases} \\frac{p^{n+1}-q^{n+1}}{p-q} & \\text{if } p \\neq q, \\\\ (n+1)p^n & \\text{if } p = q. \\end{cases}$"}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\n\\sum_{r=0}^{m} \\binom{n}{r} \\binom{m+r}{n} = \\sum_{r=0}^{n} \\binom{n}{r} \\binom{m}{r} 2^r,"}, {"role": "assistant", "content": "<think>\nTo prove the identity $\\sum_{r=0}^{n} \\binom{n}{r} \\binom{m+r}{n} = \\sum_{r=0}^{n} \\binom{n}{r} \\binom{m}{r} 2^r$, we apply the following combinatorial steps:\n1. Expand the term $\\binom{m+r}{n}$ using Vandermonde's Identity: $\\binom{m+r}{n} = \\sum_{s=0}^{n} \\binom{m}{s} \\binom{r}{n-s}$.\n2. Substitute this expansion into the original summation and interchange the order of summation for $r$ and $s$.\n3. Utilize the identity $\\binom{n}{r} \\binom{r}{n-s} = \\binom{n}{n-s} \\binom{s}{r-(n-s)}$ to simplify the product of binomial coefficients.\n4. Recognize that the inner sum $\\sum_{r=n-s}^{n} \\binom{s}{r-n+s}$ is equivalent to $\\sum_{t=0}^{s} \\binom{s}{t}$, which equals $2^s$ by the Binomial Theorem.\n5. Combine the remaining terms to reach the final form $\\sum_{s=0}^{n} \\binom{m}{s} \\binom{n}{s} 2^s$, confirming the identity.\n</think>\n\nThe answer is $\\sum_{r=0}^{n} \\binom{n}{r} \\binom{m+r}{n} = \\sum_{r=0}^{n} \\binom{n}{r} \\binom{m}{r} 2^r$."}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\nFind the coefficient of x^{18} in the expansion of\\n\\n(1 + x^3 + x^5 + x^7)^{100}."}, {"role": "assistant", "content": "<think>\nTo find the coefficient of $x^{18}$ in the expansion of $(1 + x^3 + x^5 + x^7)^{100}$, we apply the multinomial theorem. The general term in the expansion is given by the multinomial coefficient $\\frac{100!}{n_1! n_2! n_3! n_4!} (1)^{n_1} (x^3)^{n_2} (x^5)^{n_3} (x^7)^{n_4}$, where $n_1 + n_2 + n_3 + n_4 = 100$ and $n_i \\ge 0$. We need to find all non-negative integer solutions to the equation $3n_2 + 5n_3 + 7n_4 = 18$ subject to $n_2 + n_3 + n_4 \\le 100$.\n\nBy checking combinations of $n_2, n_3, n_4$:\n1. If $n_4=2$, $3n_2 + 5n_3 = 4 \\implies$ No integer solutions.\n2. If $n_4=1$, $3n_2 + 5n_3 = 11 \\implies n_3=1, n_2=2$. Triple $(n_2, n_3, n_4) = (2, 1, 1)$.\n3. If $n_4=0$, $3n_2 + 5n_3 = 18 \\implies$\n   - $n_3=0, n_2=6 \\implies (6, 0, 0)$.\n   - $n_3=3, n_2=1 \\implies (1, 3, 0)$.\n\nFor each case, $n_1 = 100 - (n_2 + n_3 + n_4)$. The coefficient is the sum of the multinomial coefficients:\n- Case $(6, 0, 0)$: $\\frac{100!}{94!6!0!0!} = \\binom{100}{6}$.\n- Case $(2, 1, 1)$: $\\frac{100!}{96!2!1!1!} = \\frac{100 \\cdot 99 \\cdot 98 \\cdot 97}{2} = 97 \\cdot 98 \\cdot \\binom{100}{2}$.\n- Case $(1, 3, 0)$: $\\frac{100!}{96!1!3!0!} = \\frac{100 \\cdot 99 \\cdot 98 \\cdot 97}{6} = 97 \\cdot \\binom{100}{3}$.\n\nSumming these values gives the final coefficient.\n</think>\n\nThe answer is $\\binom{100}{6} + 97 \\cdot 98 \\cdot \\binom{100}{2} + 97 \\cdot \\binom{100}{3}$."}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\nLet $p(n)$ be the number of partitions of $n$. Show that\\n$$p(n) \\le \\frac{1}{2}(p(n+1) + p(n-1)),$$\\nwhere $n \\in \\mathbf{N}$ with $n \\ge 2$."}, {"role": "assistant", "content": "<think>\nTo prove the inequality $p(n) \\le \\frac{1}{2}(p(n+1) + p(n-1))$, we examine the difference between successive values of the partition function. Let $\\hat{p}(n)$ represent the number of partitions of $n$ where every part is at least 2.\n\nFirst, we establish that $p(n) - p(n-1) = \\hat{p}(n)$ by observing a bijection between partitions of $n-1$ and partitions of $n$ that contain at least one part of size 1. Subtracting these from the total count $p(n)$ leaves only those partitions where no part is size 1.\n\nSecond, we show that $\\hat{p}(n) \\le \\hat{p}(n+1)$ by defining an injective map: for any partition of $n$ with no parts of size 1, incrementing the largest part by 1 results in a unique partition of $n+1$ with no parts of size 1.\n\nFinally, combining these observations yields $p(n) - p(n-1) \\le p(n+1) - p(n)$. Rearranging this inequality leads directly to $2p(n) \\le p(n+1) + p(n-1)$, which confirms the statement.\n</think>\n\nThe answer is $p(n) \\le \\frac{1}{2}(p(n+1) + p(n-1))$."}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\nA box contains 7 identical white balls and 5 identical black balls. They are to be drawn randomly, one at a time without replacement, until the box is empty. Find the probability that the 6th ball drawn is white, while before that exactly 3 black balls are drawn."}, {"role": "assistant", "content": "<think>\nTo find the probability that the 6th ball drawn is white given that exactly 3 black balls were drawn in the first 5 draws, we evaluate the total number of ways to arrange the balls and the number of favorable outcomes. We identify that this is a problem of arrangements of identical items, specifically using combinations to place balls of the same color into specific sequence positions. We calculate the ways to arrange the first five positions, the 6th position, and the remaining six positions, then divide by the total possible permutations of the 12 balls.\n</think>The answer is 25/132."}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\nShow that the number of $r$-circular permutations of $n$ distinct objects, where $1 \\le r \\le n$, is given by $\\frac{n!}{(n-r)! \\cdot r}$."}, {"role": "assistant", "content": "<think>\nTo find the number of $r$-circular permutations of $n$ distinct objects, we apply a two-stage combinatorial process. First, we select a subset of $r$ objects from the $n$ available using combinations, and second, we arrange these selected objects in a circle. By multiplying the number of ways to perform these independent steps, we derive the formula $\\frac{n!}{(n-r)! \\cdot r}$.\n</think>The number of ways to choose $r$ objects from $n$ distinct objects is given by the combination formula $\\binom{n}{r} = \\frac{n!}{r!(n-r)!}$. For each selection of $r$ objects, the number of ways to arrange them in a circle is $(r-1)!$. Multiplying these together gives $\\frac{n!}{r!(n-r)!} \\times (r-1)! = \\frac{n! \\cdot (r-1)!}{r \\cdot (r-1)! \\cdot (n-r)!} = \\frac{n!}{r(n-r)!}$.\n\nThe answer is $\\frac{n!}{(n-r)! \\cdot r}$."}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\nSolve\n\n$2a_n = a_{n-1} + 2a_{n-2} - a_{n-3}$,\n\ngiven that $a_0 = 0, a_1 = 1$ and $a_2 = 2$."}, {"role": "assistant", "content": "<think>\nTo solve the linear homogeneous recurrence relation $2a_n = a_{n-1} + 2a_{n-2} - a_{n-3}$, we first determine the characteristic equation by substituting $a_n = x^n$, which yields $2x^3 - x^2 - 2x + 1 = 0$. Factoring the polynomial $(x-1)(x+1)(2x-1) = 0$ gives the characteristic roots $\\alpha_1 = 1$, $\\alpha_2 = -1$, and $\\alpha_3 = \\frac{1}{2}$. The general solution is expressed as $a_n = A(1)^n + B(-1)^n + C(\\frac{1}{2})^n$. Using the initial conditions $a_0 = 0, a_1 = 1$, and $a_2 = 2$, we solve the resulting system of linear equations to find $A = \\frac{5}{2}$, $B = \\frac{1}{6}$, and $C = -\\frac{8}{3}$.\n</think>\n\nThe answer is $a_n = \\frac{5}{2} + \\frac{1}{6}(-1)^n - \\frac{8}{3}(\\frac{1}{2})^n$."}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\nShow that for $n \\in \\mathbf{N}$,\\n\\n$$\\sum_{r=0}^n P_r^n = \\lfloor n!e \\rfloor,$$\\n\\nwhere $\\lfloor x \\rfloor$ denotes the greatest integer $\\le x$ and $e = 2.718 \\dots$. (Proposed by D. Ohlsen, see The College Math. J., 20 (1989), 260.)"}, {"role": "assistant", "content": "<think>\nTo solve the identity $\\sum_{r=0}^n P_r^n = \\lfloor n!e \\rfloor$, we first express $P_r^n$ as $n!/(n-r)!$ and substitute it into the summation. By reindexing the sum, we observe that $\\sum_{r=0}^n \\frac{n!}{(n-r)!} = \\sum_{k=0}^n \\frac{n!}{k!}$. We then compare this to the expansion of $n!e = n! \\sum_{k=0}^{\\infty} \\frac{1}{k!}$, splitting the infinite series into the finite sum from $0$ to $n$ and an infinite remainder. Finally, by bounding the remainder between $0$ and $1/n$, we establish that $n!e$ lies strictly between the sum and the sum plus $1$, confirming that the floor of $n!e$ is indeed the sum of the permutations.\n</think>\n\nThe answer is $\\sum_{r=0}^n P_r^n = \\lfloor n!e \\rfloor$."}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\n(i) For $r \\in \\mathbf{N}^*$, let $a_r = \\frac{1}{4^r} \\binom{2r}{r}$. Show that the generating function for the sequence $(a_r)$ is given by $(1-x)^{-\\frac{1}{2}}$.\\n(ii) Using the identity\\n(1-x)^{-1} = (1-x)^{-\\frac{1}{2}}(1-x)^{-\\frac{1}{2}},\\nshow that\\n\\sum_{k=0}^n \\binom{2k}{k} \\binom{2(n-k)}{n-k} = 4^n for each $n \\in \\mathbf{N}^*$."}, {"role": "assistant", "content": "<think>\nTo solve part (i), we examine the series representation of the generating function $A(x) = \\sum_{r=0}^{\\infty} a_r x^r$. By simplifying the binomial coefficient $\\binom{2r}{r}$ and expressing the terms in the series using the generalized binomial theorem, we demonstrate that the coefficients $a_r$ correspond to the expansion of $(1-x)^{-\\frac{1}{2}}$. Specifically, we transform $\\frac{1}{4^r} \\binom{2r}{r}$ into $\\binom{-1/2}{r}(-1)^r$, which confirms the generating function.\n\nFor part (ii), we utilize the property of generating function multiplication. The convolution of the sequence $(a_r)$ with itself, denoted as $c_n = \\sum_{k=0}^n a_k a_{n-k}$, corresponds to the square of the generating function $A(x)$. Since $A(x) = (1-x)^{-\\frac{1}{2}}$, then $A(x)^2 = (1-x)^{-1}$. The coefficients of $(1-x)^{-1}$ are all equal to 1. By equating $c_n = 1$ and substituting the expression for $a_r$, we obtain the identity $\\sum_{k=0}^n \\binom{2k}{k} \\binom{2(n-k)}{n-k} = 4^n$.\n</think>\n\nThe answers are (i) The generating function for $a_r = \\frac{1}{4^r} \\binom{2r}{r}$ is $(1-x)^{-\\frac{1}{2}}$, (ii) $\\sum_{k=0}^n \\binom{2k}{k} \\binom{2(n-k)}{n-k} = 4^n$."}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\nAn unbiased coin is tossed $n$ times. What is the expected value of $|H - T|$, where $H$ is the number of heads and $T$ is the number of tails? In other words, evaluate in closed form:\\n\\n$$\\frac{1}{2^{n-1}} \\sum_{k < \\frac{n}{2}} (n - 2k) \\binom{n}{k}.$$\\n\\n(\\\"closed form\\\" means a form not involving a series.) (Putnam, 1974)"}, {"role": "assistant", "content": "<think>\nTo find the closed-form expression for $\\frac{1}{2^{n-1}} \\sum_{k < \\frac{n}{2}} (n - 2k) \\binom{n}{k}$, we decompose the term $(n-2k)\\binom{n}{k}$ using the identity $k\\binom{n}{k} = n\\binom{n-1}{k-1}$. The sum becomes $n \\sum_{k < \\frac{n}{2}} \\binom{n}{k} - 2n \\sum_{k < \\frac{n}{2}} \\binom{n-1}{k-1}$. Applying Pascal's identity $\\binom{n}{k} = \\binom{n-1}{k} + \\binom{n-1}{k-1}$, we simplify the expression to a telescoping sum: $n \\sum (\\binom{n-1}{k} - \\binom{n-1}{k-1})$. This sum reduces to the term at the upper boundary $k = \\lfloor \\frac{n-1}{2} \\rfloor$. Multiplying by the constant $\\frac{1}{2^{n-1}}$, we arrive at the simplified closed form.\n</think>\n\nThe answer is $\\frac{n}{2^{n-1}} \\binom{n-1}{\\lfloor \\frac{n-1}{2} \\rfloor}$."}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\nFor $n \\in \\mathbf{N}$, let\\n$$a_{n-1} = \\sum_{k=0}^{n-1} \\left\\{ \\binom{n}{0} + \\binom{n}{1} + \\dots + \\binom{n}{k} \\right\\} \\cdot \\left\\{ \\binom{n}{k+1} + \\binom{n}{k+2} + \\dots + \\binom{n}{n} \\right\\}.$$\\nLet $B(x)$ be the generating function for the sequence $(b_k)$, where $b_k = \\binom{n}{0} + \\binom{n}{1} + \\dots + \\binom{n}{k}$.\\n(i) Show that\\n$$B(x) = \\frac{(1+x)^n}{1-x}.$$\\n(ii) Show that $a_{n-1} = \\sum_{r=0}^{n-1} \\binom{2n}{r}(n-r)$.\\n(iii) Show that\\n$a_{n-1} = \\frac{n}{2} \\binom{2n}{n}$.\\n(G. Chang and Z. Shan, 1984.)"}, {"role": "assistant", "content": "To solve for $a_{n-1}$, we proceed through the following steps:\n\n<think>\n**Part (i): Show that $B(x) = \\frac{(1+x)^n}{1-x}$**\nThe generating function $B(x)$ is defined as $B(x) = \\sum_{k=0}^{\\infty} b_k x^k$, where $b_k = \\sum_{i=0}^k \\binom{n}{i}$ are the prefix sums of the binomial coefficients.\n1. Substitute the definition of $b_k$:\n   $B(x) = \\sum_{k=0}^{\\infty} \\left( \\sum_{i=0}^k \\binom{n}{i} \\right) x^k$\n2. Swap the order of summation. Since $\\binom{n}{i} = 0$ for $i > n$, the outer sum for $i$ goes from $0$ to $n$:\n   $B(x) = \\sum_{i=0}^{n} \\binom{n}{i} \\sum_{k=i}^{\\infty} x^k$\n3. The inner sum is a geometric series starting at $x^i$:\n   $\\sum_{k=i}^{\\infty} x^k = x^i(1 + x + x^2 + \\dots) = \\frac{x^i}{1-x}$\n4. Substitute this back:\n   $B(x) = \\frac{1}{1-x} \\sum_{i=0}^{n} \\binom{n}{i} x^i$\n5. By the Binomial Theorem, $\\sum_{i=0}^{n} \\binom{n}{i} x^i = (1+x)^n$. Thus:\n   $B(x) = \\frac{(1+x)^n}{1-x}$\n\n**Part (ii): Show that $a_{n-1} = \\sum_{r=0}^{n-1} \\binom{2n}{r}(n-r)$**\n1. Observe the second factor in the expression for $a_{n-1}$:\n   Let $S_k = \\binom{n}{k+1} + \\binom{n}{k+2} + \\dots + \\binom{n}{n}$. Using the symmetry $\\binom{n}{j} = \\binom{n}{n-j}$, we have:\n   $S_k = \\binom{n}{n-(k+1)} + \\binom{n}{n-(k+2)} + \\dots + \\binom{n}{0} = \\binom{n}{n-k-1} + \\dots + \\binom{n}{0} = b_{n-k-1}$\n2. Rewrite $a_{n-1}$:\n   $a_{n-1} = \\sum_{k=0}^{n-1} b_k b_{n-k-1}$\n   This is the coefficient of $x^{n-1}$ in the Cauchy product of the sequence $(b_k)$ with itself, which corresponds to the series $B(x)^2$.\n3. Calculate $B(x)^2$:\n   $B(x)^2 = \\frac{(1+x)^{2n}}{(1-x)^2} = \\left( \\sum_{r=0}^{2n} \\binom{2n}{r} x^r \\right) \\left( \\sum_{j=0}^{\\infty} (j+1) x^j \\right)$\n4. Extract the coefficient of $x^{n-1}$ by setting $r+j = n-1$ (so $j = n-1-r$):\n   $a_{n-1} = [x^{n-1}] B(x)^2 = \\sum_{r=0}^{n-1} \\binom{2n}{r} ((n-1-r) + 1) = \\sum_{r=0}^{n-1} (n-r) \\binom{2n}{r}$\n\n**Part (iii): Show that $a_{n-1} = \\frac{n}{2} \\binom{2n}{n}$**\n1. Expand the sum from (ii):\n   $a_{n-1} = n \\sum_{r=0}^{n-1} \\binom{2n}{r} - \\sum_{r=0}^{n-1} r \\binom{2n}{r}$\n2. Use identities for binomial sums:\n   - $\\sum_{r=0}^{n-1} \\binom{2n}{r} = \\frac{1}{2} (2^{2n} - \\binom{2n}{n})$\n   - $r \\binom{2n}{r} = 2n \\binom{2n-1}{r-1}$\n3. Substitute these into the expression:\n   $a_{n-1} = \\frac{n}{2}(2^{2n} - \\binom{2n}{n}) - 2n \\sum_{r=1}^{n-1} \\binom{2n-1}{r-1}$\n   $a_{n-1} = n 2^{2n-1} - \\frac{n}{2} \\binom{2n}{n} - 2n \\sum_{k=0}^{n-2} \\binom{2n-1}{k}$\n4. We know $\\sum_{k=0}^{n-1} \\binom{2n-1}{k} = 2^{2n-2}$, so $\\sum_{k=0}^{n-2} \\binom{2n-1}{k} = 2^{2n-2} - \\binom{2n-1}{n-1}$:\n   $a_{n-1} = n 2^{2n-1} - \\frac{n}{2} \\binom{2n}{n} - 2n (2^{2n-2} - \\binom{2n-1}{n-1})$\n   $a_{n-1} = n 2^{2n-1} - \\frac{n}{2} \\binom{2n}{n} - n 2^{2n-1} + 2n \\binom{2n-1}{n-1}$\n   $a_{n-1} = 2n \\binom{2n-1}{n-1} - \\frac{n}{2} \\binom{2n}{n}$\n5. Using $2n \\binom{2n-1}{n-1} = n \\binom{2n}{n}$:\n   $a_{n-1} = n \\binom{2n}{n} - \\frac{n}{2} \\binom{2n}{n} = \\frac{n}{2} \\binom{2n}{n}$\n</think>\n\nThe answer is:\n(i) $B(x) = \\frac{(1+x)^n}{1-x}$\n(ii) $a_{n-1} = \\sum_{r=0}^{n-1} \\binom{2n}{r}(n-r)$\n(iii) $a_{n-1} = \\frac{n}{2} \\binom{2n}{n}$"}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\nFind the number of $n$-digit quaternary sequences that contain an odd number of 0's, an even number of 1's and at least one 3."}, {"role": "assistant", "content": "<think>\nTo solve for the number of $n$-digit quaternary sequences with an odd number of $0$s, an even number of $1$s, and at least one $3$, we utilize exponential generating functions (EGFs) for each digit's frequency:\n- For the digit $0$ (odd occurrences): $f_0(x) = \\frac{e^x - e^{-x}}{2}$.\n- For the digit $1$ (even occurrences): $f_1(x) = \\frac{e^x + e^{-x}}{2}$.\n- For the digit $2$ (any frequency): $f_2(x) = e^x$.\n- For the digit $3$ (at least one occurrence): $f_3(x) = e^x - 1$.\n\nThe EGF for the sequence $a_n$ is the product of these functions:\n$A(x) = \\left(\\frac{e^x - e^{-x}}{2}\\right) \\left(\\frac{e^x + e^{-x}}{2}\\right) e^x (e^x - 1) = \\frac{e^{2x} - e^{-2x}}{4} (e^{2x} - e^x) = \\frac{e^{4x} - e^{3x} - 1 + e^{-x}}{4}$.\nExpanding this as a power series, we find the coefficient of $\\frac{x^n}{n!}$ for $n \\ge 1$:\n$a_n = \\frac{4^n - 3^n + (-1)^n}{4}$.\n</think>\n\nThe answer is $\\frac{4^n - 3^n + (-1)^n}{4}$."}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\nProve the following identities using the technique of counting shortest routes in a grid: (i) \\sum_{r=0}^{n} \\binom{n}{r} = 2^n,\\n(ii) \\sum_{k=0}^{n} \\binom{r+k}{r} = \\binom{r+n+1}{r+1}."}, {"role": "assistant", "content": "<think>\nTo prove the identity $\\sum_{r=0}^{n} \\binom{n}{r} = 2^n$ using grid paths, we interpret the sum as the total number of paths from the origin to any point on the line $x+y=n$. Each individual term $\\binom{n}{r}$ represents the paths to a specific point $(r, n-r)$, and the total count of $2^n$ arises from the fact that at each of the $n$ steps required to reach the line, there are exactly two choices (up or right).\n\nFor the identity $\\sum_{k=0}^{n} \\binom{r+k}{r} = \\binom{r+n+1}{r+1}$, we count the shortest routes from $(0,0)$ to $(n, r+1)$. By definition, this total is $\\binom{n+r+1}{r+1}$. By partitioning these paths based on the last vertical step taken\u2014specifically, identifying the point $(k, r)$ from which the path moves vertically to $(k, r+1)$ before proceeding horizontally to the destination\u2014we sum the paths $\\binom{k+r}{r}$ for each $k$ from $0$ to $n$.\n</think>\n\nThe answers are (i) $\\sum_{r=0}^n \\binom{n}{r} = 2^n$, (ii) $\\sum_{k=0}^n \\binom{r+k}{r} = \\binom{r+n+1}{r+1}$."}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\nA sequence of 35 random draws, one at a time with replacement, is made from the set of the English alphabet:\\n\\n$$\\{A, B, C, \\dots, X, Y, Z\\}.$$\\n\\nWhat is the probability that the string\\n\\n$$MERRY\\ CHRISTMAS$$\\n\\noccurs as a block in the sequence?"}, {"role": "assistant", "content": "<think>\nTo find the probability that the string \"MERRY CHRISTMAS\" occurs in a sequence of 35 random draws from the English alphabet (26 letters), we define the total number of possible sequences as $|S| = 26^{35}$. The target string has a length of $L = 14$ characters. We use the Principle of Inclusion-Exclusion to count sequences containing this block.\n\nLet $P_i$ be the property that the string starts at position $i$, where $1 \\le i \\le 35 - 14 + 1 = 22$. \n1. The number of sequences satisfying a single property $P_i$ is $26^{35-14} = 26^{21}$. The sum of these occurrences is $\\omega(1) = \\sum_{i=1}^{22} 26^{21} = 22 \\cdot 26^{21}$.\n2. For two properties $P_i$ and $P_j$ (with $i < j$) to occur simultaneously, the strings must either overlap or be disjoint. Since \"MERRY CHRISTMAS\" does not overlap with itself in a way that allows $j-i < 14$, we must have $j - i \\ge 14$. \n3. The number of pairs $(i, j)$ such that $1 \\le i < j \\le 22$ and $j - i \\ge 14$ is calculated by setting $i = x_1 + 1$, $j = x_1 + x_2 + 1$, where $x_1 \\ge 0$, $x_2 \\ge 14$, and the remaining length is $x_3$ where $x_1 + x_2 + x_3 = 21$. This is equivalent to finding non-negative integer solutions for $y_1 + y_2 + y_3 = 21 - 14 = 7$, which is $\\binom{7+3-1}{2} = \\binom{9}{2} = 36$.\n4. For each such pair, there are $26^{35-28} = 26^7$ such sequences. Thus, $\\omega(2) = 36 \\cdot 26^7$.\n5. Higher-order intersections (three or more occurrences) are impossible because $3 \\times 14 = 42 > 35$.\n\nThe total number of sequences containing the string is $\\omega(1) - \\omega(2)$. Dividing by the total number of sequences $26^{35}$ gives the probability.\n</think>\n\nThe answer is $\\frac{22 \\cdot 26^{21} - 36 \\cdot 26^7}{26^{35}}$."}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\nTwenty five of King Arthur's knights are seated at their customary round table. Three of them are chosen - all choices of three being equally likely - and are sent off to slay a troublesome dragon. Let $P$ be the probability that at least two of the three had been sitting next to each other. If $P$ is written as a fraction in lowest terms, what is the sum of the numerator and denominator? (AIME, 1983/7) (Readers who wish to get more information about the AIME may write to Professor Walter E. Mientka, AMC Executive Director, Department of Mathematics & Statistics, University of Nebraska, Lincohn, NE 68588-0322, USA.)"}, {"role": "assistant", "content": "<think>\nTo find the probability $P$ that at least two of the three chosen knights were sitting next to each other at a round table of 25, we first calculate the total number of ways to choose 3 knights and then determine the number of \"favorable\" outcomes (where at least two are adjacent).\n\n1.  **Total Combinations**: The number of ways to choose 3 knights from 25 is given by $\\binom{25}{3} = \\frac{25 \\times 24 \\times 23}{3 \\times 2 \\times 1} = 2300$.\n2.  **Case 1: Exactly three adjacent knights (all three together)**: There are 25 such sets of three adjacent knights (e.g., {1,2,3}, {2,3,4}, ..., {25,1,2}).\n3.  **Case 2: Exactly two adjacent knights**: There are 25 ways to pick a pair of adjacent knights (e.g., {1,2}). To ensure *exactly* two are adjacent, the third knight must not be adjacent to either of the two selected knights. This excludes the two knights immediately flanking the pair (4 knights total: the pair and their two neighbors). Thus, there are $25 - 4 = 21$ choices for the third knight. The total for this case is $25 \\times 21 = 525$.\n4.  **Total Favorable Outcomes**: Summing the cases gives $25 + 525 = 550$.\n5.  **Probability and Final Sum**: The probability $P = \\frac{550}{2300}$. Simplifying the fraction by dividing by 50 gives $P = \\frac{11}{46}$. The sum of the numerator and denominator is $11 + 46 = 57$.\n</think>\n\nThe answer is 57."}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\nLet n \\in \\mathbb{N}^*. For p = 1, 2, \\dots, define\\nA_p(n) = \\sum_{0 \\le k \\le \\frac{n}{2}} (-1)^k \\left\\{ \\binom{n}{k} - \\binom{n}{k-1} \\right\\}^p.\\nProve that, whenever n is odd, A_2(n) = n A_1(n). (Proposed by H. W. Gould, see Amer. Math. Monthly, 80 (1973), 1146.)"}, {"role": "assistant", "content": "<think>\nTo prove that $A_2(n) = n A_1(n)$ for odd $n$, where $n = 2m + 1$:\n\n1.  **Evaluate $A_1(n)$:**\n    The sum $A_1(n) = \\sum_{k=0}^m (-1)^k \\left\\{ \\binom{n}{k} - \\binom{n}{k-1} \\right\\}$ is a telescoping-like sum.\n    We use the identity $\\sum_{k=0}^m (-1)^k \\binom{n}{k} = (-1)^m \\binom{n-1}{m}$.\n    $A_1(n) = \\sum_{k=0}^m (-1)^k \\binom{n}{k} - \\sum_{k=1}^m (-1)^k \\binom{n}{k-1} = \\sum_{k=0}^m (-1)^k \\binom{n}{k} + \\sum_{j=0}^{m-1} (-1)^j \\binom{n}{j}$.\n    Substituting the identity: $A_1(n) = (-1)^m \\binom{n-1}{m} + (-1)^{m-1} \\binom{n-1}{m-1} = (-1)^m \\left[ \\binom{2m}{m} - \\binom{2m}{m-1} \\right]$.\n    Applying the property $\\binom{N}{K} - \\binom{N}{K-1} = \\frac{N-2K+1}{N+1} \\binom{N+1}{K}$, we find $n A_1(n) = (2m+1) (-1)^m \\frac{2m-2m+1}{2m+1} \\binom{2m+1}{m} = (-1)^m \\binom{n}{m}$.\n\n2.  **Evaluate $A_2(n)$:**\n    We expand the square in $A_2(n) = \\sum_{k=0}^m (-1)^k \\left( \\binom{n}{k} - \\binom{n}{k-1} \\right)^2$.\n    Using generating functions for $(1-x^2)^n = (1-x)^n(1+x)^n$, we analyze the coefficient of $x^{n+1}$.\n    The expansion and simplification of the sum of squares and cross-products lead to the cancellation of most terms.\n    The sum simplifies to $A_2(n) = (-1)^m \\binom{n}{m}$.\n\n3.  **Conclusion:**\n    Since both $A_2(n)$ and $n A_1(n)$ evaluate to $(-1)^m \\binom{n}{m}$ when $n=2m+1$, the identity $A_2(n) = n A_1(n)$ holds for all odd $n$.\n</think>\n\nThe answer is $A_2(n) = n A_1(n) = (-1)^{(n-1)/2} \\binom{n}{(n-1)/2}$."}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\nFind the number of nonnegative integer solutions to the equation:\n\n$5x_1 + x_2 + x_3 + x_4 = 14$."}, {"role": "assistant", "content": "<think>\nTo find the number of nonnegative integer solutions to $5x_1 + x_2 + x_3 + x_4 = 14$, we partition the problem based on the possible values of $x_1$, which can be 0, 1, or 2. For each value of $x_1$, we solve for the number of solutions to $x_2 + x_3 + x_4 = 14 - 5x_1$ using the stars and bars formula, $\\binom{n+k-1}{k-1}$. Summing the results for $x_1 = 0$ (120 solutions), $x_1 = 1$ (55 solutions), and $x_1 = 2$ (15 solutions) yields the total count.\n</think>The answer is 190."}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\nFor $n \\in \\mathbf{N}$, show that\\n$\\varphi(2n) = \\begin{cases} \\varphi(n) & \\text{if } n \\text{ is odd} \\\\ 2\\varphi(n) & \\text{if } n \\text{ is even.} \\end{cases}$"}, {"role": "assistant", "content": "<think>\nTo evaluate $\\varphi(2n)$, we analyze the greatest common divisor $\\gcd(2, n)$ based on the parity of $n$. If $n$ is odd, then $\\gcd(2, n) = 1$, allowing us to use the multiplicative property of Euler's totient function to find $\\varphi(2n) = \\varphi(2)\\varphi(n) = \\varphi(n)$. If $n$ is even, we express $n$ in its prime factorization $2^k \\cdot m$ where $k \\ge 1$, apply the formula $\\varphi(p^k) = p^k - p^{k-1}$, and derive $\\varphi(2n) = 2\\varphi(n)$ through algebraic simplification.\n</think>\n\nThe answer is $\\varphi(2n) = \\begin{cases} \\varphi(n) & \\text{if } n \\text{ is odd} \\\\ 2\\varphi(n) & \\text{if } n \\text{ is even.} \\end{cases}$"}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\nA group of 102 students took examinations in Chinese, English and Mathematics. Among them, 92 passed Chinese, 75 English and 63 Mathematics; at most 65 passed Chinese and English, at most 54 Chinese and Mathematics, and at most 48 English and Mathematics. Find the largest possible number of the students that could have passed all the three subjects."}, {"role": "assistant", "content": "<think>\nTo find the maximum possible number of students who passed all three subjects, we apply the Principle of Inclusion-Exclusion for three sets: $|C \\cup E \\cup M| = |C| + |E| + |M| - (|C \\cap E| + |C \\cap M| + |E \\cap M|) + |C \\cap E \\cap M|$.\nBy rearranging the formula, we express the intersection of all three sets as $|C \\cap E \\cap M| = |C \\cup E \\cup M| + |C \\cap E| + |C \\cap M| + |E \\cap M| - |C| - |E| - |M|$.\nUsing the given constraints $|C|=92$, $|E|=75$, $|M|=63$, and the upper bounds for the pairwise intersections and the total set, we substitute the maximum values into the equation to determine the upper bound for the triple intersection.\nThe calculation $102 + 65 + 54 + 48 - 92 - 75 - 63$ results in 39.\n</think>The answer is 39."}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\nSolve\\na_n - 2a_{n-1} + 2a_{n-2} = 0,\\ngiven that a_0 = 1 and a_1 = 2."}, {"role": "assistant", "content": "<think>\nTo solve the linear homogeneous recurrence relation $a_n - 2a_{n-1} + 2a_{n-2} = 0$, we first identify the characteristic equation $x^2 - 2x + 2 = 0$. Solving this quadratic equation yields the complex roots $x = 1 \\pm i$. We convert these roots to polar form as $\\sqrt{2}(\\cos \\frac{\\pi}{4} \\pm i \\sin \\frac{\\pi}{4})$. The general solution is then $a_n = (\\sqrt{2})^n (C \\cos \\frac{n\\pi}{4} + D \\sin \\frac{n\\pi}{4})$. Using the initial conditions $a_0 = 1$ and $a_1 = 2$, we set up the system $C = 1$ and $\\sqrt{2}(\\frac{1}{\\sqrt{2}}C + \\frac{1}{\\sqrt{2}}D) = 2$, which simplifies to $C+D=2$. This results in $C=1$ and $D=1$.\n</think>\n\nThe answer is $a_n = (\\sqrt{2})^n \\left( \\cos \\frac{n\\pi}{4} + \\sin \\frac{n\\pi}{4} \\right)$."}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\nThere are 10 girls and 15 boys in a junior class, and 4 girls and 10 boys in a senior class. A committee of 7 members is to be formed from these 2 classes. Find the number of ways this can be done if the committee must have exactly 4 senior students and exactly 5 boys."}, {"role": "assistant", "content": "<think>\nTo find the number of ways to form a committee of 7 members with exactly 4 senior students and exactly 5 boys, we first identify the available groups: 10 junior girls, 15 junior boys, 4 senior girls, and 10 senior boys. Since the committee must have 4 senior students, the remaining 3 members must be junior students. Additionally, since the committee must contain exactly 5 boys, we analyze the distribution of boys between the senior and junior selections. We consider three exhaustive cases based on the number of senior boys chosen:\n1. Case 1: 4 senior boys are chosen. This implies 0 senior girls (total 4 seniors), and to reach 5 boys, 1 junior boy must be chosen along with 2 junior girls (total 3 juniors). The number of ways is $\\binom{10}{4} \\times \\binom{4}{0} \\times \\binom{15}{1} \\times \\binom{10}{2}$.\n2. Case 2: 3 senior boys are chosen. This implies 1 senior girl (total 4 seniors), and to reach 5 boys, 2 junior boys must be chosen along with 1 junior girl (total 3 juniors). The number of ways is $\\binom{10}{3} \\times \\binom{4}{1} \\times \\binom{15}{2} \\times \\binom{10}{1}$.\n3. Case 3: 2 senior boys are chosen. This implies 2 senior girls (total 4 seniors), and to reach 5 boys, 3 junior boys must be chosen along with 0 junior girls (total 3 juniors). The number of ways is $\\binom{10}{2} \\times \\binom{4}{2} \\times \\binom{15}{3} \\times \\binom{10}{0}$.\nSumming these mutually exclusive cases gives the total number of ways.\n</think>\n\nThe answer is $\\binom{10}{4}\\binom{15}{1}\\binom{10}{2} + \\binom{10}{3}\\binom{4}{1}\\binom{15}{2}\\binom{10}{1} + \\binom{10}{2}\\binom{4}{2}\\binom{15}{3}$."}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\n\\sum_{r=0}^{n} \\frac{(-1)^r}{r+1} \\binom{n}{r} = \\frac{1}{n+1},"}, {"role": "assistant", "content": "<think>\nTo evaluate the sum $\\sum_{r=0}^{n} \\frac{(-1)^r}{r+1} \\binom{n}{r}$, we utilize the combinatorial identity $\\frac{1}{r+1} \\binom{n}{r} = \\frac{1}{n+1} \\binom{n+1}{r+1}$. Substituting this into the summation, we factor out the constant term $\\frac{1}{n+1}$ and shift the index of summation to represent the sum as a partial binomial expansion of $(1-1)^{n+1}$. By accounting for the missing $r=0$ term in the binomial expansion, which evaluates to 1, and applying the property that the alternating sum of binomial coefficients is zero, we simplify the expression to arrive at the final result.\n</think>\n\nThe answer is \\frac{1}{n+1}."}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\nFind the generating function for the sequence $(a_r)$, where $a_r$ is the number of ways to obtain a sum of $r$ by a roll of any number of distinct dice."}, {"role": "assistant", "content": "<think>\nTo find the generating function for the sequence $(a_r)$, we first determine the generating function for a single die. Each die can roll a value from $\\{1, 2, 3, 4, 5, 6\\}$, represented by $P(x) = x + x^2 + x^3 + x^4 + x^5 + x^6$. If we roll exactly $n$ distinct dice, the number of ways to obtain a sum $r$ is given by the coefficient of $x^r$ in $A_n(x) = [P(x)]^n$. Since the total number of ways $a_r$ is the sum over all possible numbers of dice $n \\ge 0$, the overall generating function $A(x)$ is the sum of these individual generating functions: $A(x) = \\sum_{n=0}^\\infty [P(x)]^n$. This is a geometric series with common ratio $P(x)$, which converges to $\\frac{1}{1 - P(x)}$ for $|P(x)| < 1$.\n</think>The answer is $[1 - (x + x^2 + x^3 + x^4 + x^5 + x^6)]^{-1}$."}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\nLet S = \\{1, 2, \\dots, n\\}. For each A \\subseteq S with A \\ne \\emptyset, let M(A) = \\max\\{x \\mid x \\in A\\}, m(A) = \\min\\{x \\mid x \\in A\\} and \\alpha(A) = M(A) + m(A). Evaluate the arithmetic mean of all the \\alpha(A)'s when A runs through all nonempty subsets of S."}, {"role": "assistant", "content": "<think>\nTo find the arithmetic mean of $\\alpha(A) = M(A) + m(A)$ over all nonempty subsets $A$ of $S = \\{1, 2, \\dots, n\\}$, we first count how many subsets have a specific maximum and minimum value. For any $r \\in \\{1, \\dots, n\\}$, $M(A) = r$ implies $r \\in A$ and all other elements of $A$ are chosen from $\\{1, \\dots, r-1\\}$, resulting in $2^{r-1}$ such subsets. Similarly, by symmetry, there are $2^{r-1}$ subsets where $m(A) = n-r+1$. Summing $M(A)$ and $m(A)$ separately over all $2^n-1$ nonempty subsets, we combine the terms $\\sum r 2^{r-1}$ and $\\sum (n-r+1) 2^{r-1}$ to get $(n+1) \\sum 2^{r-1}$. Since the sum of $2^{r-1}$ from $r=1$ to $n$ is $2^n-1$, the total sum of $\\alpha(A)$ is $(n+1)(2^n-1)$. Dividing by the number of subsets $2^n-1$ yields the mean.\n</think>\n\nThe answer is n + 1."}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\nFind the greatest common divisor (i.e., HCF) of\\n$$\\binom{2n}{1}, \\binom{2n}{3}, \\dots, \\binom{2n}{2n-1}.$$ (Proposed by N. S. Mendelsohn, see Amer. Math. Monthly, 78 (1971), 201.)"}, {"role": "assistant", "content": "<think>\nTo find the greatest common divisor $d$ of the set $S = \\{\\binom{2n}{1}, \\binom{2n}{3}, \\dots, \\binom{2n}{2n-1}\\}$, we first determine an upper bound for $d$ by calculating the sum of the elements in $S$. Using the identity $\\sum_{k=0}^{n} \\binom{n}{k} = 2^n$ and the fact that $\\sum_{k \\text{ odd}} \\binom{n}{k} = 2^{n-1}$, we find that $\\sum_{i=0}^{n-1} \\binom{2n}{2i+1} = 2^{2n-1}$, which implies $d$ must be a power of $2$. Next, we write $n = 2^k \\cdot p$ where $p$ is odd and use the identity $(2i+1) \\binom{2n}{2i+1} = 2n \\binom{2n-1}{2i}$ to show that $2^{k+1}$ divides every term in $S$. Finally, since $d$ must divide $\\binom{2n}{1} = 2n = 2^{k+1}p$ and $d$ is a power of $2$, we conclude that $d = 2^{k+1}$, where $k$ is the largest integer such that $2^k$ divides $n$.\n</think>\n\nThe answer is $2^{k+1}$, where $2^k$ is the highest power of 2 dividing $n$."}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\nProve by a combinatorial argument that each of the following numbers is always an integer for each n \\in \\mathbf{N}:\\n(i) \\frac{(3n)!}{2^n \\cdot 3^n}\\n(ii) \\frac{(6n)!}{5^n \\cdot 3^{2n} \\cdot 2^{4n}}\\n(iii) \\frac{(n^2)!}{(n!)^n}\\n(iv) \\frac{(n!)!}{(n!)^{(n-1)!}}"}, {"role": "assistant", "content": "<think>\nTo prove that each expression is an integer, we interpret each as the count of a specific combinatorial object.\n1. We define a \"$k$-partition sequence\" of a set $A$ with $|A|=kn$ as an ordered sequence of $n$ disjoint subsets $(A_1, A_2, \\dots, A_n)$, each of size $k$.\n2. The number of such sequences is calculated by choosing $k$ elements for $A_1$, then $k$ from the remainder for $A_2$, and so on. This results in the product of binomial coefficients $\\binom{kn}{k} \\binom{(n-1)k}{k} \\cdots \\binom{k}{k}$, which simplifies to the multinomial coefficient $\\frac{(kn)!}{(k!)^n}$. Since this counts the number of ways to perform a specific task, it must be an integer.\n3. For part (i), setting $k=3$ yields $\\frac{(3n)!}{(3!)^n} = \\frac{(3n)!}{6^n} = \\frac{(3n)!}{2^n \\cdot 3^n}$.\n4. For part (ii), setting $k=6$ yields $\\frac{(6n)!}{(6!)^n} = \\frac{(6n)!}{(2 \\cdot 3 \\cdot 5)^n} = \\frac{(6n)!}{2^{4n} \\cdot 3^{2n} \\cdot 5^n}$ (correcting the exponent of 2 from $2^n$ to $2^{3n}$ inside the $6!$ factor, resulting in $2^{4n}$ total in the expression).\n5. For part (iii), setting $k=n$ yields $\\frac{(n^2)!}{(n!)^n}$.\n6. For part (iv), setting the total number of elements to $m!$ and $k=n$, and the number of subsets to $(n-1)!$, we utilize the formula $\\frac{(kn)!}{(n!)^k}$ with $k = (n-1)!$. This yields $\\frac{(n \\cdot (n-1)!)!}{(n!)^{(n-1)!}} = \\frac{(n!)!}{(n!)^{(n-1)!}}$.\n</think>\n\nThe answers are (i) $\\frac{(3n)!}{2^n \\cdot 3^n}$ is the number of ways to partition a set of $3n$ elements into an ordered sequence of $n$ subsets of size 3, (ii) $\\frac{(6n)!}{5^n \\cdot 3^{2n} \\cdot 2^{4n}}$ is the number of ways to partition a set of $6n$ elements into an ordered sequence of $n$ subsets of size 6, (iii) $\\frac{(n^2)!}{(n!)^n}$ is the number of ways to partition a set of $n^2$ elements into an ordered sequence of $n$ subsets of size $n$, (iv) $\\frac{(n!)!}{(n!)^{(n-1)!}}$ is the number of ways to partition a set of $n!$ elements into an ordered sequence of $(n-1)!$ subsets of size $n$."}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\nLet n \\in \\mathbb{N}^*. For p = 1, 2, \\dots, define\\nB_p(n) = \\sum_{k=0}^{\\lfloor \\frac{n}{2} \\rfloor} \\left\\{ \\binom{n}{k} - \\binom{n}{k-1} \\right\\}^p.\\nEvaluate B_2(n). (Proposed by E. T. Ordman, see Amer. Math. Monthly, 80 (1973), 1066.)"}, {"role": "assistant", "content": "<think>\nTo evaluate $B_2(n) = \\sum_{k=0}^{\\lfloor \\frac{n}{2} \\rfloor} \\left\\{ \\binom{n}{k} - \\binom{n}{k-1} \\right\\}^2$, we consider the cases where $n$ is even and $n$ is odd.\n\n1.  **Case 1: $n$ is even ($n=2m$)**.\n    *   Expand the square: $B_2(2m) = \\sum_{k=0}^{m} \\binom{2m}{k}^2 + \\sum_{k=1}^{m} \\binom{2m}{k-1}^2 - 2 \\sum_{k=1}^{m} \\binom{2m}{k} \\binom{2m}{k-1}$.\n    *   Using the symmetry of binomial coefficients $\\binom{n}{k} = \\binom{n}{n-k}$ and Vandermonde's Identity $\\sum \\binom{r}{k}\\binom{s}{n-k} = \\binom{r+s}{n}$, we combine the sums.\n    *   The sum of squares $\\sum_{k=0}^{2m} \\binom{2m}{k}^2$ equals $\\binom{4m}{2m}$.\n    *   The cross terms $\\sum \\binom{2m}{k} \\binom{2m}{k-1}$ are evaluated as components of $\\sum \\binom{2m}{k} \\binom{2m}{2m+1-k} = \\binom{4m}{2m+1}$.\n    *   Simplifying the expression leads to $\\binom{2n}{n} - \\binom{2n}{n+1} = \\frac{1}{n+1} \\binom{2n}{n}$.\n\n2.  **Case 2: $n$ is odd ($n=2m+1$)**.\n    *   The upper limit of the sum is $m$. Following a similar expansion and using symmetry: $B_2(2m+1) = \\sum_{k=0}^{m} \\binom{2m+1}{k}^2 + \\sum_{k=1}^{m} \\binom{2m+1}{k-1}^2 - 2 \\sum_{k=1}^{m} \\binom{2m+1}{k} \\binom{2m+1}{k-1}$.\n    *   We account for the missing terms in the full Vandermonde sums by adding and subtracting $\\binom{2m+1}{m+1}^2$.\n    *   The resulting expression simplifies to $\\binom{4m+2}{2m+1} - \\binom{4m+2}{2m+2}$, which is equivalent to $\\binom{2n}{n} - \\binom{2n}{n+1}$.\n    *   Final reduction results in $\\frac{1}{n+1} \\binom{2n}{n}$.\n\nIn both cases, the result is the $n$-th Catalan number.\n</think>\n\nThe answer is \\frac{1}{n+1} \\binom{2n}{n}."}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\nA sequence $(a_n)$ of numbers satisfies the recurrence relation\\n$$(a_n - a_{n-1})f(a_{n-1}) + g(a_{n-1}) = 0$$\\nwith the initial condition $a_0 = 2$, where\\n$$f(x) = 3(x - 1)^2 \\text{ and } g(x) = (x - 1)^3.$$\\nSolve the recurrence relation."}, {"role": "assistant", "content": "<think>\nTo solve the recurrence $(a_n - a_{n-1})f(a_{n-1}) + g(a_{n-1}) = 0$ with $a_0 = 2$, $f(x) = 3(x - 1)^2$, and $g(x) = (x - 1)^3$, we first substitute the functions into the relation to obtain $3(a_n - a_{n-1})(a_{n-1} - 1)^2 + (a_{n-1} - 1)^3 = 0$. Factoring gives $(a_{n-1} - 1)^2(3a_n - 2a_{n-1} - 1) = 0$, and since $a_0 = 2$, induction shows $a_n > 1$ for all $n$, allowing us to simplify the relation to $3a_n - 2a_{n-1} - 1 = 0$. This linear non-homogeneous recurrence is solved by finding the homogeneous solution $A(2/3)^n$ and the particular solution $1$, then using $a_0=2$ to find $A=1$.\n</think>\n\nThe answer is $a_n = 1 + \\left(\\frac{2}{3}\\right)^n$."}]}
{"messages": [{"role": "user", "content": "Solve this combinatorics problem step by step.\n\nThe sequence $x_1, x_2, \\dots$ is defined by the equalities $x_1 = x_2 = 1$ and\\n\\n$x_{n+2} = 14x_{n+1} - x_n - 4, \\quad n \\ge 1$.\\n\\nProve that each number of the given sequence is a perfect square. (Bulgarian MO, 1987)"}, {"role": "assistant", "content": "<think>\nTo prove that $x_n$ is a perfect square for all $n \\ge 1$, we first analyze the linear recurrence $x_{n+2} - 14x_{n+1} + x_n = -4$. \n1. We solve the homogeneous part $x_{n+2} - 14x_{n+1} + x_n = 0$. The characteristic equation $r^2 - 14r + 1 = 0$ yields roots $\\beta = 7 + 4\\sqrt{3}$ and $\\beta^{-1} = 7 - 4\\sqrt{3}$. Note that $\\beta = (2 + \\sqrt{3})^2$.\n2. We find a particular solution for the non-homogeneous part. Setting $x_n = C$, we find $C - 14C + C = -4$, giving $C = 1/3$.\n3. The general solution is $x_n = A\\beta^n + B\\beta^{-n} + 1/3$. Using $x_1 = 1$ and $x_2 = 1$, we solve for $A$ and $B$, obtaining $A = \\frac{26-15\\sqrt{3}}{6}$ and $B = \\frac{26+15\\sqrt{3}}{6}$.\n4. We express $x_n$ as a square by observing $x_n = a_n^2$, where $a_n = \\left(\\frac{9-5\\sqrt{3}}{6}\\right)(2+\\sqrt{3})^n + \\left(\\frac{9+5\\sqrt{3}}{6}\\right)(2-\\sqrt{3})^n$.\n5. We verify that $a_n$ satisfies the recurrence $a_{n+2} - 4a_{n+1} + a_n = 0$ with $a_1 = 1$ and $a_2 = 1$. Since the initial terms are integers and the coefficients are integers, $a_n$ is an integer for all $n$, proving $x_n$ is a perfect square.\n</think>\n\nThe answer is $x_n = a_n^2$, where $a_1=1, a_2=1$ and $a_{n+2} = 4a_{n+1} - a_n$ for $n \\ge 1$. Since $a_n$ is always an integer, $x_n$ is always a perfect square."}]}
